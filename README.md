# Adaptive Integration of Categorical and Multi-relational Ontologies with EHR Data for Medical Concept Embedding
=========================================

ADORE is a deep learning framework that  do adaptive integration of categorical and multi-relational ontologies by a category-aware graph attention network.





#### Running ADORE

**STEP 1: Installation**  

1. Install python and pytorch. We use Python 3.8, pytorch  1.9.0

2. If you plan to use GPU computation, install [CUDA](https://developer.nvidia.com/cuda-downloads)

3. Downloadthe ADORE repository  

**STEP 2: Run ADORE with MIMIC-III**  

This step describes how to run, with minimum number of steps, GRAM for predicting future diagnosis codes using MIMIC-III. 

0. Dowload data from [MIMIC-III](https://mimic.physionet.org/gettingstarted/access/) 

1. Run "process_mimic.py" to preprocess MIMIC-III. 


2. Use "build_trees.py" to build files that contain the ancestor information of each medical code. 
This requires "ccs_multi_dx_tool_2015.csv" (Multi-level CCS for ICD9), which can be downloaded from 
[here](https://www.hcup-us.ahrq.gov/toolssoftware/ccs/Multi_Level_CCS_2015.zip).


3. Run ADORE using the ".seqs" file generated by build_trees.py. 
The ".seqs" file contains the sequence of visits for each patient. Each visit consists of multiple diagnosis codes.
Instead of using the same ".seqs" file as both the training feature and the training label, 
The command is `python adore.py <seqs file> <3digitICD9.seqs file> <tree file prefix> <output path>`. 



